% Stručný návod:
% - Připravit CSV soubor s údaji oddělenými středníky v UTF-8
% - Přímo v souboru je potřeba vyplnit jména podpisujích osob a funkce (těsně před begin{document}
%
% Vytvořil Aleš Flandera 2015 %

\documentclass[8pt,a4paper,portrait]{article}

\pagestyle{empty}

\usepackage[czech,english]{babel}
\usepackage{fontspec}
\usepackage{xunicode}
\usepackage{epstopdf}
\usepackage{amsbsy}

\usepackage[left=1.5cm,right=1.5cm,top=1.5cm,bottom=2cm]{geometry}

\usepackage{ifthen}
\usepackage{datatool}
\usepackage{comment}

\usepackage[printwatermark]{xwatermark}
\usepackage{tikz}

\usepackage{booktabs}
\usepackage{longtable}
\usepackage{csvsimple}

\usepackage{fancyhdr}
\usepackage{lastpage}

%\pagestyle{empty}
\pagestyle{fancy}
\fancyhf{}
\renewcommand{\headrulewidth}{0pt}
%\rfoot{Strana \thepage \hspace{1pt} z \pageref{LastPage}}

\usepackage{array}
\newcolumntype{L}[1]{>{\raggedright\let\newline\\\arraybackslash\hspace{0pt}}p{#1}}

\begin{comment}
\newsavebox\mybox
\savebox\mybox{%
\begin{tikzpicture}
    \node at (0,0) {\includegraphics{fs.pdf}};
    \draw[fill=white,fill opacity=0.8,draw opacity=0] (-3.5,-3.5) rectangle (3.5,3.5);
\end{tikzpicture}
}

\newwatermark[
	allpages,
	angle=0,
	scale=2,
	xpos=0,
	ypos=0
]{\usebox\mybox}
\end{comment}


%velikosti písma
\newcommand{\PismoMale}{\fontsize{15}{15}\selectfont}
\newcommand{\PismoStredni}{\fontsize{18}{18}\selectfont}
\newcommand{\PismoVelke}{\fontsize{27}{27}\selectfont}
\newcommand{\PismoDiplom}{\fontsize{45}{45}\selectfont}
\newcommand{\PismoDiplomEN}{\fontsize{45}{45}\selectfont}
\newcommand{\PismoSoutez}{\fontsize{35}{35}\selectfont}
\newcommand{\PismoPaticka}{\fontsize{8}{10}\selectfont}
\newcommand{\PismoOsoby}{\fontsize{10}{10}\selectfont}

\newcommand{\MezeraDiplom}{\vspace{0.7cm}}
\newcommand{\MezeraZaklad}{\vspace{0.4cm}}
\newcommand{\MezeraCara}{\vspace{0.3cm}}
\newcommand{\MezeraPodpisy}{\vspace{1.5cm}}
\newcommand{\MezeraTym}{\vspace{0.5cm}}

\newcommand{\osobaLeva}{Oldřich Holcner}
\newcommand{\osobaPrava}{Mgr. Aleš Flandera}
\newcommand{\OsobaLevaFceCZ}{vedoucí Fyziklání online}
\newcommand{\OsobaPravaFceCZ}{předseda ústřední komise}



\begin{document}
\DTLsetseparator{;}
\DTLloaddb{category}{vysledkovky/data.csv} % cesta k CSV souboru hír
\DTLforeach{category}{%
\category=Kategorie,%
\year=Rocnik,%
\date=Datum}{% mapování dat do maker, klíče jsou specifikovány v prvním řádku souboru CSV

%\thisfancyput(20.5cm,-4.5cm){\includegraphics[height=5cm]{logoUK}}
%\thisfancyput(-4.5cm,-4.5cm){\includegraphics[height=5cm]{logoMFF}}

\ifthenelse{\equal{\category}{org}}
{}
{
\setcounter{page}{1}
\ifthenelse{\equal{\category}{A}}
	{\rfoot{Strana \thepage \hspace{1pt} z \pageref{page-A}}}
	{\ifthenelse{\equal{\category}{B}}
		{\rfoot{Strana \thepage \hspace{1pt} z \pageref{page-B}}}
		{\rfoot{Strana \thepage \hspace{1pt} z \pageref{page-C}}}}
%
%
\begin{center}
\begin{minipage}{0.40\textwidth}
\centering
{\fontsize{16}{18}\selectfont \textbf{Fyzikální korespondenční seminář, který zastřešuje}}
\end{minipage}
%
\hfill
%
\begin{minipage}{0.55\textwidth}
\begin{center}
\includegraphics[width=\textwidth]{vysledkovky/logotyp_fakulty3.eps}\\
\end{center}
\end{minipage}
%
%
\MezeraTym
%
%
\begin{center}
{\PismoMale \textbf{vyhlašuje výsledkovou listinu}}\\
%
\MezeraZaklad
%
{\PismoVelke \textbf{kategorie středoškoláci \category}}\\
%
\MezeraZaklad
%
{\PismoMale \year{}. ročníku ústředního kola s mezinárodní účastí soutěže v řešení příkladů z fyziky\\}
%
\MezeraZaklad
%
{\PismoSoutez \textbf{Fyziklání online}\\}
%
\MezeraZaklad
%
{\PismoMale pořádané dne \date{} na internetových stránkách online.fyziklani.cz}\\
%
\end{center}


\csvreader[
longtable=c r@{~}l c L{9cm},% l,
%longtable=c c c p{7cm} l,
separator=semicolon,
table head=
\toprule\bfseries \# & \bfseries Jméno & \bfseries Příjmení & \bfseries Ročník & \bfseries Škola \\ \midrule\endhead
\bottomrule\endfoot,
late after line=\\,
before reading={\catcode`\#=12},after reading={\catcode`\#=6}
]{vysledkovky/list-\category.csv}{1=\ico,2=\nazskoly,3=\skola,4=\prijmeni,5=\jmeno,6=\roknar,7=\idtym,8=\stat,9=\kraj,10=\kategorie,11=\poradi}{\poradi & \jmeno & \prijmeni & \roknar & \skola}% & \kraj}



%
\MezeraPodpisy
\begin{minipage}{0.25\textwidth}
%\centering
%\hrule
%\MezeraCara
%{\PismoOsoby
%\osobaLeva\\
%\OsobaLevaFceCZ
%}
\end{minipage}
%
\hspace{8cm}
%
\begin{minipage}{0.25\textwidth}
\centering
\hrule
\MezeraCara
{\PismoOsoby
\osobaPrava\\
\OsobaPravaFceCZ
}
\end{minipage}
%
\end{center}
%
\vfill
{\PismoPaticka \noindent{}Fyziklání online je soutěž vyhlašovaná Univerzitou Karlovou v Praze Matematicko fyzikální fakultou. Financována je přes Oddělení pro vnější vztahy a propagaci MFF UK. Spoluvyhlašovatelem soutěže je Ministerstvo školství, mládeže a~tělovýchovy. Soutěž připravují organizátoři Fyzikálního korespondenčního semináře MFF UK. Zaštítěna je Ústavem teoretické fyziky, Ústavem jaderné a~částicové fyziky a~Katedrou didaktiky fyziky MFF UK. Samotná soutěž probíhá na serveru Katedry aplikované matematiky MFF UK. Základ herního systému pochází ze soutěže Interlos.}


\ifthenelse{\equal{\category}{A}}
	{\label{page-A}}
	{\ifthenelse{\equal{\category}{B}}
		{\label{page-B}}
		{\label{page-C}}}
}
	

\newpage
} % konec foreach
%
\end{document}
